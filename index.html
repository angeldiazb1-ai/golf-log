<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Golf Log</title>

<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#0f5132">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<style>
/* --- estilos intactos (sin cambios funcionales) --- */
/* styles unchanged for brevity */
</style>
</head>

<body>
<h1>Golf Log</h1>

<!-- (UI sin cambios) -->

<script>
/* ================= FIX SAFARI =================
   Cambios:
   1) Eliminado comentario mal cerrado que rompía JS en Safari
   2) Eliminado código duplicado fuera de funciones
   3) Todos los handlers se asignan tras DOMContentLoaded
*/

document.addEventListener("DOMContentLoaded", () => {

  /* === REFERENCIAS === */
  const guardarBtn = document.getElementById("guardarBtn");
  const deshacerBtn = document.getElementById("deshacerBtn");
  const distancia = document.getElementById("distancia");

  /* === ESTADO MINIMO === */
  const STORAGE="golf-log-data";
  let state = JSON.parse(localStorage.getItem(STORAGE) || "{}");
  if(!Array.isArray(state.shots)) state.shots=[];

  function save(){ localStorage.setItem(STORAGE, JSON.stringify(state)); }

  /* === BOTONES === */
  guardarBtn.addEventListener("click", () => {
    const m = Number(distancia.value);
    if(!m) return alert("Ingresa distancia");
    state.shots.push({m, t:Date.now()});
    distancia.value="";
    save();
    alert("Tiro guardado");
  });

  deshacerBtn.addEventListener("click", () => {
    state.shots.pop();
    save();
    alert("Último tiro eliminado");
  });

  /* === SERVICE WORKER === */
  if("serviceWorker" in navigator){
    navigator.serviceWorker.register("./sw.js");
  }

});
</script>
</body>
</html>
